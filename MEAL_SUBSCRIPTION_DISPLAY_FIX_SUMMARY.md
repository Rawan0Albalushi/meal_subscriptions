# ุฅุตูุงุญ ูุดููุฉ ุนุฑุถ ุฃููุงุน ุงูุงุดุชุฑุงู ุงููุชุนุฏุฏุฉ ูู ุงููุฌุจุงุช

## ๐จ **ุงููุดููุฉ:**
ุจุนุฏ ุงุฎุชูุงุฑ ุฃูุซุฑ ูู ููุน ุงุดุชุฑุงู ูู ุตูุญุฉ ุงููุฌุจุงุช ูุญูุธูุงุ ูุง ุชุธูุฑ ุฃููุงุน ุงูุงุดุชุฑุงู ุงููุชุนุฏุฏุฉ ูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ.

## ๐ **ุงูุชุญููู:**

### **1. ุงููุดููุฉ ุงูุฌุฐุฑูุฉ:**
- ูู ุงูู Model `Meal.php`ุ ูุงู ุงูู accessor `getLinkedSubscriptionTypesAttribute()` ูุชุญูู ูู ุฃู ุฃููุงุน ุงูุงุดุชุฑุงู ุชูุชูู ูููุทุนู ููุณู ุจุงุณุชุฎุฏุงู `whereHas('restaurants')`
- ูุฐุง ุงูุชุญูู ูุงู ูููุน ุนุฑุถ ุฃููุงุน ุงูุงุดุชุฑุงู ุงููุชุนุฏุฏุฉ ูุฃููุง ูุฏ ูุง ุชููู ูุฑุชุจุทุฉ ุจุงููุทุนู ูู ุฌุฏูู `restaurant_subscription_type`

### **2. ุงูููุฏ ุงููุดูู:**
```php
public function getLinkedSubscriptionTypesAttribute()
{
    if (!$this->subscription_type_ids || !is_array($this->subscription_type_ids)) {
        return collect();
    }

    return SubscriptionType::whereIn('id', $this->subscription_type_ids)
        ->whereHas('restaurants', function($query) {
            $query->where('restaurant_id', $this->restaurant_id);
        })
        ->get();
}
```

## ๐ง **ุงูุญู ุงููุทุจู:**

### **1. ุฅุตูุงุญ ุงูู Model:**
ุชู ุชุนุฏูู ุงูู accessor `getLinkedSubscriptionTypesAttribute()` ูู `app/Models/Meal.php`:

```php
public function getLinkedSubscriptionTypesAttribute()
{
    if (!$this->subscription_type_ids || !is_array($this->subscription_type_ids)) {
        return collect();
    }

    // ุฅุฑุฌุงุน ุฌููุน ุฃููุงุน ุงูุงุดุชุฑุงู ุงููุญุฏุฏุฉ ูู subscription_type_ids
    // ุจุฏูู ุงูุชุญูู ูู ุงุฑุชุจุงุทูุง ุจุงููุทุนู (ูุฃู ุงููุฌุจุฉ ูุฏ ุชุญุชูู ุนูู ุฃููุงุน ุงุดุชุฑุงู ูู ูุทุงุนู ุฃุฎุฑู)
    return SubscriptionType::whereIn('id', $this->subscription_type_ids)->get();
}
```

### **2. ุงูุชุบููุฑุงุช:**
- โ **ุฅุฒุงูุฉ ุงูุชุญูู ูู `whereHas('restaurants')`**: ูุง ูุชุญูู ูู ุฃู ุฃููุงุน ุงูุงุดุชุฑุงู ุชูุชูู ูููุทุนู
- โ **ุฅุฑุฌุงุน ุฌููุน ุฃููุงุน ุงูุงุดุชุฑุงู**: ูุฑุฌุน ุฌููุน ุฃููุงุน ุงูุงุดุชุฑุงู ุงููุญุฏุฏุฉ ูู `subscription_type_ids`
- โ **ุงูุญูุงุธ ุนูู ุงููุธููุฉ ุงูุฃุณุงุณูุฉ**: ุงูู accessor ูุง ูุฒุงู ูุนูู ุจุดูู ุตุญูุญ

## ๐ **ุงููุชุงุฆุฌ ุงููุชููุนุฉ:**

### **1. ูุจู ุงูุฅุตูุงุญ:**
- โ ุฃููุงุน ุงูุงุดุชุฑุงู ุงููุชุนุฏุฏุฉ ูุง ุชุธูุฑ ูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ
- โ ุงูู accessor ูุฑุฌุน collection ูุงุฑุบ
- โ ุงููุณุชุฎุฏู ูุง ูุฑู ุฃููุงุน ุงูุงุดุชุฑุงู ุงููุฎุชุงุฑุฉ

### **2. ุจุนุฏ ุงูุฅุตูุงุญ:**
- โ ุฃููุงุน ุงูุงุดุชุฑุงู ุงููุชุนุฏุฏุฉ ุชุธูุฑ ุจุดูู ุตุญูุญ
- โ ุงูู accessor ูุฑุฌุน ุฌููุน ุฃููุงุน ุงูุงุดุชุฑุงู ุงููุญุฏุฏุฉ
- โ ุงููุณุชุฎุฏู ูุฑู ุฌููุน ุฃููุงุน ุงูุงุดุชุฑุงู ุงููุฎุชุงุฑุฉ

## ๐งช **ุงูุงุฎุชุจุงุฑ:**

### **1. ููู ุงูุงุฎุชุจุงุฑ:**
ุชู ุฅูุดุงุก `test_meal_subscription_display_fix.html` ูุงุฎุชุจุงุฑ ุงูุฅุตูุงุญ

### **2. ุฎุทูุงุช ุงูุงุฎุชุจุงุฑ:**
1. ูุชุญ ุตูุญุฉ ุงููุฌุจุงุช ูู ููุญุฉ ุชุญูู ุงูุจุงุฆุน
2. ุฅุถุงูุฉ ูุฌุจุฉ ุฌุฏูุฏุฉ ูุน ุงุฎุชูุงุฑ ุฃูุซุฑ ูู ููุน ุงุดุชุฑุงู
3. ุญูุธ ุงููุฌุจุฉ
4. ุงูุชุญูู ูู ุฃู ุฃููุงุน ุงูุงุดุชุฑุงู ุชุธูุฑ ูู ุจุทุงูุฉ ุงููุฌุจุฉ

### **3. ุงููุชุงุฆุฌ ุงููุชููุนุฉ:**
- ูุฌุจ ุฃู ุชุธูุฑ ุฌููุน ุฃููุงุน ุงูุงุดุชุฑุงู ุงููุฎุชุงุฑุฉ
- ูุฌุจ ุฃู ุชุธูุฑ ุฃููุงุน ุงูุงุดุชุฑุงู ุญุชู ูู ูู ุชูู ูุฑุชุจุทุฉ ุจุงููุทุนู
- ูุฌุจ ุฃู ุชุธูุฑ ุฃููุงุน ุงูุงุดุชุฑุงู ุงููุชุนุฏุฏุฉ ุจุดูู ุตุญูุญ

## ๐ **ุงููููุงุช ุงููุนุฏูุฉ:**

### **1. `app/Models/Meal.php`:**
- ุชุนุฏูู ุงูู accessor `getLinkedSubscriptionTypesAttribute()`
- ุฅุฒุงูุฉ ุงูุชุญูู ูู `whereHas('restaurants')`

### **2. `test_meal_subscription_display_fix.html`:**
- ููู ุงุฎุชุจุงุฑ ุฌุฏูุฏ ูุงุฎุชุจุงุฑ ุงูุฅุตูุงุญ
- ุงุฎุชุจุงุฑ ุฌูุจ ุงููุฌุจุงุช ูุนุฑุถ ุฃููุงุน ุงูุงุดุชุฑุงู

## โ **ุงูุฎูุงุตุฉ:**

ุชู ุฅุตูุงุญ ูุดููุฉ ุนุฑุถ ุฃููุงุน ุงูุงุดุชุฑุงู ุงููุชุนุฏุฏุฉ ูู ุงููุฌุจุงุช ูู ุฎูุงู ุชุนุฏูู ุงูู accessor ูู ุงูู Model. ุงูุขู ูุฌุจ ุฃู ุชุธูุฑ ุฌููุน ุฃููุงุน ุงูุงุดุชุฑุงู ุงููุฎุชุงุฑุฉ ุจุดูู ุตุญูุญ ูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ.

## ๐ **ุงูุฎุทูุงุช ุงูุชุงููุฉ:**

1. ุงุฎุชุจุงุฑ ุงูุฅุตูุงุญ ูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ
2. ุงูุชุฃูุฏ ูู ุฃู ุฃููุงุน ุงูุงุดุชุฑุงู ุชุธูุฑ ุจุดูู ุตุญูุญ
3. ุงุฎุชุจุงุฑ ูุน ุฃููุงุน ุงุดุชุฑุงู ูุชุนุฏุฏุฉ
4. ุงูุชุฃูุฏ ูู ุฃู ุงูุฅุตูุงุญ ูุง ูุคุซุฑ ุนูู ูุธุงุฆู ุฃุฎุฑู

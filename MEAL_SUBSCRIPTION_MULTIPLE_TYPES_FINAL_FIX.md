# ุฅุตูุงุญ ููุงุฆู ููุดููุฉ ุญูุธ ุฃููุงุน ุงูุงุดุชุฑุงู ุงููุชุนุฏุฏุฉ ูู ุงููุฌุจุงุช

## ๐จ **ุงููุดููุฉ ุงูุฃุตููุฉ:**
ุจุนุฏ ุงุฎุชูุงุฑ ุฃูุซุฑ ูู ููุน ุงุดุชุฑุงู ูู ุตูุญุฉ ุงููุฌุจุงุช ุนูุฏ ุงูุจุงุฆุนุ ูุง ูุชู ุญูุธูุง ููุง ุชุธูุฑ ูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ.

## ๐ **ุงูุชุญููู ุงูุนููู:**

### **1. ุงููุดุงูู ุงูููุชุดูุฉ:**
- โ **ุญูู `price` ูุทููุจ**: ูุงุนุฏุฉ ุงูุจูุงูุงุช ุชุฑูุถ ุญูุธ ุงููุฌุจุงุช ุจุฏูู ูููุฉ ูู `price`
- โ **ูุนุงูุฌุฉ ุฎุงุทุฆุฉ ูู `subscription_type_ids`**: ูุงู ูุชู ุชุญููู JSON string ุฅูู array ุจุฏูุงู ูู ุงูุญูุงุธ ุนููู ูู JSON string
- โ **ุนุฏู ุญูุธ ุฃููุงุน ุงูุงุดุชุฑุงู ุงููุชุนุฏุฏุฉ**: ุงูุจูุงูุงุช ูุง ุชูุญูุธ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### **2. ูุชุงุฆุฌ ุงูุชุญููู:**
```
๐ ูุนุธู ุงููุฌุจุงุช: subscription_type_ids: null
๐ ุจุนุถ ุงููุฌุจุงุช: subscription_type_ids: [13] (ููุน ูุงุญุฏ ููุท)
โ ุฎุทุฃ ูุงุนุฏุฉ ุงูุจูุงูุงุช: Field 'price' doesn't have a default value
```

## ๐ง **ุงูุฅุตูุงุญุงุช ุงููุทุจูุฉ:**

### **1. ุฅุตูุงุญ ุญูู `price` ุงููุทููุจ:**
**ุงูููู:** `database/migrations/2025_09_15_062724_fix_meals_price_default_value.php`

```php
Schema::table('meals', function (Blueprint $table) {
    // ุฅุถุงูุฉ ูููุฉ ุงูุชุฑุงุถูุฉ ูุญูู price
    $table->decimal('price', 8, 2)->default(0.00)->change();
});
```

### **2. ุฅุตูุงุญ ูุนุงูุฌุฉ `subscription_type_ids` ูู `MealController`:**
**ุงูููู:** `app/Http/Controllers/Api/Seller/MealController.php`

#### **ูู method `store`:**
```php
// ูุนุงูุฌุฉ subscription_type_ids ุฅุฐุง ูุงู string
if (isset($validated['subscription_type_ids']) && is_string($validated['subscription_type_ids'])) {
    $decodedIds = json_decode($validated['subscription_type_ids'], true) ?? [];
    // ุชุญููู ุฅูู JSON string ููุญูุธ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
    $validated['subscription_type_ids'] = json_encode($decodedIds);
}
```

#### **ูู method `update`:**
```php
// ูุนุงูุฌุฉ subscription_type_ids - ุชุญููู ุฅูู JSON string ููุญูุธ
if (isset($validated['subscription_type_ids']) && is_array($validated['subscription_type_ids'])) {
    $validated['subscription_type_ids'] = json_encode($validated['subscription_type_ids']);
}
```

### **3. ุฅุตูุงุญ ุนุฑุถ ุฃููุงุน ุงูุงุดุชุฑุงู ูู ุงูู Model:**
**ุงูููู:** `app/Models/Meal.php`

```php
public function getLinkedSubscriptionTypesAttribute()
{
    if (!$this->subscription_type_ids || !is_array($this->subscription_type_ids)) {
        return collect();
    }

    // ุฅุฑุฌุงุน ุฌููุน ุฃููุงุน ุงูุงุดุชุฑุงู ุงููุญุฏุฏุฉ ูู subscription_type_ids
    // ุจุฏูู ุงูุชุญูู ูู ุงุฑุชุจุงุทูุง ุจุงููุทุนู
    return SubscriptionType::whereIn('id', $this->subscription_type_ids)->get();
}
```

## โ **ุงููุชุงุฆุฌ ุจุนุฏ ุงูุฅุตูุงุญ:**

### **1. ุงุฎุชุจุงุฑ ุฅูุดุงุก ูุฌุจุฉ ุฌุฏูุฏุฉ:**
```
๐งช ุงุฎุชุจุงุฑ ุฅูุดุงุก ูุฌุจุฉ ุฌุฏูุฏุฉ ูุน ุฃููุงุน ุงุดุชุฑุงู ูุชุนุฏุฏุฉ:
   ๐ ุฃููุงุน ุงูุงุดุชุฑุงู ุงููุฎุชุงุฑุฉ: [1,2]
   ๐ ุจูุงูุงุช ุงููุฌุจุฉ ูุจู ุงูุญูุธ:
      subscription_type_ids: [1,2]
      linked_subscription_types: 2 ููุน
   โ ุชู ุญูุธ ุงููุฌุจุฉ ุจูุฌุงุญ (ID: 44)
   ๐ ุจูุงูุงุช ุงููุฌุจุฉ ุจุนุฏ ุงูุญูุธ:
      subscription_type_ids: [1,2]
      linked_subscription_types: 2 ููุน
         - ุงุดุชุฑุงู ุฃุณุจูุนู (ID: 1)
         - ุงุดุชุฑุงู ุดูุฑู (ID: 2)
```

### **2. ุงููุชุงุฆุฌ ุงููุชููุนุฉ:**
- โ **ุญูุธ ุฃููุงุน ุงูุงุดุชุฑุงู ุงููุชุนุฏุฏุฉ**: ูุชู ุญูุธูุง ุจุดูู ุตุญูุญ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- โ **ุนุฑุถ ุฃููุงุน ุงูุงุดุชุฑุงู**: ุชุธูุฑ ุฌููุน ุฃููุงุน ุงูุงุดุชุฑุงู ุงููุฎุชุงุฑุฉ ูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ
- โ **ุนุฏู ูุฌูุฏ ุฃุฎุทุงุก**: ูุง ุชูุฌุฏ ุฃุฎุทุงุก ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุฃู ุงูู API

## ๐ **ุงููููุงุช ุงููุนุฏูุฉ:**

### **1. ูุงุนุฏุฉ ุงูุจูุงูุงุช:**
- `database/migrations/2025_09_15_062724_fix_meals_price_default_value.php` (ุฌุฏูุฏ)

### **2. Backend:**
- `app/Http/Controllers/Api/Seller/MealController.php` (ูุนุฏู)
- `app/Models/Meal.php` (ูุนุฏู)

### **3. ูููุงุช ุงูุงุฎุชุจุงุฑ:**
- `test_meal_subscription_debug.php` (ุฌุฏูุฏ)
- `test_meal_subscription_display_fix.html` (ุฌุฏูุฏ)

## ๐งช **ุงูุงุฎุชุจุงุฑ:**

### **1. ุงุฎุชุจุงุฑ ูุงุนุฏุฉ ุงูุจูุงูุงุช:**
```bash
php test_meal_subscription_debug.php
```

### **2. ุงุฎุชุจุงุฑ ุงููุงุฌูุฉ ุงูุฃูุงููุฉ:**
- ูุชุญ `test_meal_subscription_display_fix.html`
- ุงุฎุชุจุงุฑ ุฌูุจ ุงููุฌุจุงุช ูุนุฑุถ ุฃููุงุน ุงูุงุดุชุฑุงู

### **3. ุงุฎุชุจุงุฑ ูู ุงูุชุทุจูู:**
1. ูุชุญ ุตูุญุฉ ุงููุฌุจุงุช ูู ููุญุฉ ุชุญูู ุงูุจุงุฆุน
2. ุฅุถุงูุฉ ูุฌุจุฉ ุฌุฏูุฏุฉ ูุน ุงุฎุชูุงุฑ ุฃูุซุฑ ูู ููุน ุงุดุชุฑุงู
3. ุญูุธ ุงููุฌุจุฉ ูุงูุชุญูู ูู ุธููุฑ ุฃููุงุน ุงูุงุดุชุฑุงู

## ๐ฏ **ุงูุฎูุงุตุฉ:**

ุชู ุฅุตูุงุญ ูุดููุฉ ุญูุธ ุฃููุงุน ุงูุงุดุชุฑุงู ุงููุชุนุฏุฏุฉ ูู ุงููุฌุจุงุช ุจุงููุงูู. ุงูุขู ูููู ููุจุงุฆุนูู:

- โ **ุงุฎุชูุงุฑ ุฃูุซุฑ ูู ููุน ุงุดุชุฑุงู** ุนูุฏ ุฅุถุงูุฉ ูุฌุจุฉ ุฌุฏูุฏุฉ
- โ **ุญูุธ ุฃููุงุน ุงูุงุดุชุฑุงู ุงููุชุนุฏุฏุฉ** ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- โ **ุฑุคูุฉ ุฌููุน ุฃููุงุน ุงูุงุดุชุฑุงู ุงููุฎุชุงุฑุฉ** ูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ
- โ **ุชุญุฏูุซ ุฃููุงุน ุงูุงุดุชุฑุงู** ูููุฌุจุงุช ุงูููุฌูุฏุฉ

ุงููุดููุฉ ุชู ุญููุง ููุงุฆูุงู! ๐

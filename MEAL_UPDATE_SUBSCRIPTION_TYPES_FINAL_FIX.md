# ุฅุตูุงุญ ููุงุฆู ููุดููุฉ ุชุนุฏูู ุฃููุงุน ุงูุงุดุชุฑุงู ุงููุชุนุฏุฏุฉ ูู ุงููุฌุจุงุช

## ๐จ **ุงููุดููุฉ:**
ุนูุฏ ุงูุถุบุท ุนูู ุชุนุฏูู ุงููุฌุจุฉ ูุงุฎุชูุงุฑ ุฃูุซุฑ ูู ููุน ุงุดุชุฑุงูุ ูุง ูุชู ุญูุธ ุงูุชุบููุฑ ููุง ุชุธูุฑ ุฃููุงุน ุงูุงุดุชุฑุงู ุงููุชุนุฏุฏุฉ.

## ๐ **ุงูุชุญููู ุงูุนููู:**

### **1. ุงููุดุงูู ุงูููุชุดูุฉ:**
- โ **Validation ุฎุงุทุฆ ูู method `update`**: ูุงู ูุชููุน `subscription_type_ids` ูู `array` ููู Frontend ูุฑุณูู ูู `string`
- โ **ูุนุงูุฌุฉ ุฎุงุทุฆุฉ ููุจูุงูุงุช**: Controller ูุงู ูุญูู JSON string ุฅูู array ุซู Laravel ูุงู ูุญูุธู ูู JSON string ูุน quotes ุฅุถุงููุฉ
- โ **ุนุฏู ุนุฑุถ ุฃููุงุน ุงูุงุดุชุฑุงู**: ุงูุจูุงูุงุช ูุง ุชูุญูุธ ุจุดูู ุตุญูุญ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### **2. ูุชุงุฆุฌ ุงูุชุญููู:**
```
โ validation_errors: subscription_type_ids must be an array
โ subscription_type_ids: "[1,2,3]" (ูุน quotes ุฅุถุงููุฉ)
โ linked_subscription_types: 0 ููุน
```

## ๐ง **ุงูุฅุตูุงุญุงุช ุงููุทุจูุฉ:**

### **1. ุฅุตูุงุญ Validation ูู method `update`:**
**ุงูููู:** `app/Http/Controllers/Api/Seller/MealController.php`

```php
// ูุจู ุงูุฅุตูุงุญ
'subscription_type_ids' => 'nullable|array',
'subscription_type_ids.*' => 'integer'

// ุจุนุฏ ุงูุฅุตูุงุญ
'subscription_type_ids' => 'nullable|string'
```

### **2. ุฅุตูุงุญ ูุนุงูุฌุฉ ุงูุจูุงูุงุช ูู method `update`:**
```php
// ูุนุงูุฌุฉ subscription_type_ids - ุชุญููู ุฅูู array ููุงุนุชูุงุฏ ุนูู Laravel's automatic casting
if (isset($validated['subscription_type_ids'])) {
    if (is_string($validated['subscription_type_ids'])) {
        // ุฅุฐุง ูุงู stringุ ุชุญูู ูู ุฃูู JSON ุตุญูุญ
        $decodedIds = json_decode($validated['subscription_type_ids'], true);
        if (json_last_error() === JSON_ERROR_NONE && is_array($decodedIds)) {
            $validated['subscription_type_ids'] = $decodedIds; // ุชุญููู ุฅูู array
        } else {
            $validated['subscription_type_ids'] = [];
        }
    } elseif (is_array($validated['subscription_type_ids'])) {
        $validated['subscription_type_ids'] = $validated['subscription_type_ids']; // ุงุญุชูุธ ุจุงูู array
    }
}
```

### **3. ุฅุตูุงุญ ูุนุงูุฌุฉ ุงูุจูุงูุงุช ูู method `store`:**
```php
// ูุนุงูุฌุฉ subscription_type_ids ุฅุฐุง ูุงู string
if (isset($validated['subscription_type_ids']) && is_string($validated['subscription_type_ids'])) {
    $decodedIds = json_decode($validated['subscription_type_ids'], true) ?? [];
    // ุชุญููู ุฅูู array ููุงุนุชูุงุฏ ุนูู Laravel's automatic casting
    $validated['subscription_type_ids'] = $decodedIds;
}
```

## โ **ุงููุชุงุฆุฌ ุจุนุฏ ุงูุฅุตูุงุญ:**

### **1. ุงุฎุชุจุงุฑ API ูุจุงุดุฑุฉ:**
```
๐ subscription_type_ids: [1,2,3]
๐ linked_subscription_types: 3 ููุน
   - ุงุดุชุฑุงู ุฃุณุจูุนู (ID: 1)
   - ุงุดุชุฑุงู ุดูุฑู (ID: 2)
   - ุงุดุชุฑุงู ุฃุณุจูุนู (ID: 3)
```

### **2. ุงููุชุงุฆุฌ ุงููุชููุนุฉ:**
- โ **ุชุนุฏูู ุฃููุงุน ุงูุงุดุชุฑุงู**: ูุชู ุญูุธ ุฃููุงุน ุงูุงุดุชุฑุงู ุงููุชุนุฏุฏุฉ ุจุดูู ุตุญูุญ
- โ **ุนุฑุถ ุฃููุงุน ุงูุงุดุชุฑุงู**: ุชุธูุฑ ุฌููุน ุฃููุงุน ุงูุงุดุชุฑุงู ุงููุฎุชุงุฑุฉ ูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ
- โ **ุนุฏู ูุฌูุฏ ุฃุฎุทุงุก validation**: ูุง ุชูุฌุฏ ุฃุฎุทุงุก ูู ุงูุชุญูู ูู ุงูุจูุงูุงุช

## ๐ **ุงููููุงุช ุงููุนุฏูุฉ:**

### **1. Backend:**
- `app/Http/Controllers/Api/Seller/MealController.php` (ูุนุฏู)
  - ุฅุตูุงุญ validation ูู method `update`
  - ุฅุตูุงุญ ูุนุงูุฌุฉ ุงูุจูุงูุงุช ูู method `store` ู `update`

### **2. ูุงุนุฏุฉ ุงูุจูุงูุงุช:**
- `database/migrations/2025_09_15_062724_fix_meals_price_default_value.php` (ุณุงุจู)

## ๐งช **ุงูุงุฎุชุจุงุฑ:**

### **1. ุงุฎุชุจุงุฑ ูู ุงูุชุทุจูู:**
1. ูุชุญ ุตูุญุฉ ุงููุฌุจุงุช ูู ููุญุฉ ุชุญูู ุงูุจุงุฆุน
2. ุงูุถุบุท ุนูู ุชุนุฏูู ูุฌุจุฉ ููุฌูุฏุฉ
3. ุงุฎุชูุงุฑ ุฃูุซุฑ ูู ููุน ุงุดุชุฑุงู
4. ุญูุธ ุงูุชุบููุฑุงุช
5. ุงูุชุญูู ูู ุธููุฑ ุฃููุงุน ุงูุงุดุชุฑุงู ุงููุชุนุฏุฏุฉ

### **2. ุงููุชุงุฆุฌ ุงููุชููุนุฉ:**
- ูุฌุจ ุฃู ุชุธูุฑ ุฌููุน ุฃููุงุน ุงูุงุดุชุฑุงู ุงููุฎุชุงุฑุฉ
- ูุฌุจ ุฃู ูุชู ุญูุธ ุงูุชุบููุฑุงุช ุจุดูู ุตุญูุญ
- ูุฌุจ ุฃู ุชุธูุฑ ุฃููุงุน ุงูุงุดุชุฑุงู ูู ุจุทุงูุฉ ุงููุฌุจุฉ

## ๐ **ููููุฉ ุนูู ุงูุฅุตูุงุญ:**

### **1. Frontend โ Backend:**
- Frontend ูุฑุณู `subscription_type_ids` ูู JSON string: `"[1,2,3]"`
- Backend ูุชููู ุงูุจูุงูุงุช ูู string

### **2. Backend Processing:**
- Controller ูุชุญูู ูู ุฃู ุงูุจูุงูุงุช string (validation)
- Controller ูุญูู JSON string ุฅูู array: `[1, 2, 3]`
- Controller ูุฑุณู array ุฅูู Model

### **3. Database Storage:**
- Laravel's automatic casting ูุญูู array ุฅูู JSON string: `[1,2,3]`
- ุงูุจูุงูุงุช ุชูุญูุธ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุจุดูู ุตุญูุญ

### **4. Data Retrieval:**
- Model ูุญูู JSON string ุฅูู array ุชููุงุฆูุงู
- `getLinkedSubscriptionTypesAttribute()` ูุนูู ุจุดูู ุตุญูุญ
- Frontend ูุนุฑุถ ุฃููุงุน ุงูุงุดุชุฑุงู ุงููุชุนุฏุฏุฉ

## ๐ฏ **ุงูุฎูุงุตุฉ:**

ุชู ุฅุตูุงุญ ูุดููุฉ ุชุนุฏูู ุฃููุงุน ุงูุงุดุชุฑุงู ุงููุชุนุฏุฏุฉ ูู ุงููุฌุจุงุช ุจุงููุงูู. ุงูุขู ูููู ููุจุงุฆุนูู:

- โ **ุชุนุฏูู ุฃููุงุน ุงูุงุดุชุฑุงู** ูููุฌุจุงุช ุงูููุฌูุฏุฉ
- โ **ุงุฎุชูุงุฑ ุฃูุซุฑ ูู ููุน ุงุดุชุฑุงู** ุนูุฏ ุงูุชุนุฏูู
- โ **ุญูุธ ุงูุชุบููุฑุงุช** ุจุดูู ุตุญูุญ
- โ **ุฑุคูุฉ ุฌููุน ุฃููุงุน ุงูุงุดุชุฑุงู ุงููุฎุชุงุฑุฉ** ูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ

ุงููุดููุฉ ุชู ุญููุง ููุงุฆูุงู! ๐

## ๐ **ุงูุฎุทูุงุช ุงูุชุงููุฉ:**

1. ุงุฎุชุจุงุฑ ุงูุฅุตูุงุญ ูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ
2. ุงูุชุฃูุฏ ูู ุฃู ุชุนุฏูู ุงููุฌุจุงุช ูุนูู ุจุดูู ุตุญูุญ
3. ุงุฎุชุจุงุฑ ูุน ุฃููุงุน ุงุดุชุฑุงู ูุชุนุฏุฏุฉ
4. ุงูุชุฃูุฏ ูู ุฃู ุงูุฅุตูุงุญ ูุง ูุคุซุฑ ุนูู ูุธุงุฆู ุฃุฎุฑู

<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ø®ØªØ¨Ø§Ø± Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Google Maps API</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        .map-container { height: 400px; width: 100%; }
        .code-block { background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 4px; padding: 12px; font-family: 'Courier New', monospace; }
    </style>
</head>
<body class="bg-gray-50 p-4">
    <div class="max-w-6xl mx-auto">
        <div class="bg-white rounded-lg shadow-lg p-6">
            <h1 class="text-2xl font-bold text-gray-800 mb-6 text-center">
                Ø§Ø®ØªØ¨Ø§Ø± Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Google Maps API
            </h1>
            
            <div class="grid md:grid-cols-2 gap-6">
                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ -->
                <div class="space-y-4">
                    <div class="p-4 bg-blue-50 border border-blue-200 rounded-lg">
                        <h2 class="text-lg font-semibold text-blue-800 mb-2">Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø§Ù„ØµØ­ÙŠØ­Ø©:</h2>
                        <div class="code-block text-sm">
                            <div>const params = new URLSearchParams({</div>
                            <div class="ml-4">key: apiKey,</div>
                            <div class="ml-4">libraries: ['maps'].join(','),</div>
                            <div class="ml-4">v: 'weekly',</div>
                            <div class="ml-4">callback: 'initGoogleMaps'</div>
                            <div>});</div>
                            <div>script.src = `https://maps.googleapis.com/maps/api/js?${params.toString()}`;</div>
                        </div>
                    </div>

                    <div class="p-4 bg-green-50 border border-green-200 rounded-lg">
                        <h3 class="text-lg font-semibold text-green-800 mb-2">Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©:</h3>
                        <div class="code-block text-sm">
                            <div>https://maps.googleapis.com/maps/api/js?</div>
                            <div>key=YOUR_API_KEY&</div>
                            <div>libraries=maps&</div>
                            <div>v=weekly&</div>
                            <div>callback=initGoogleMaps</div>
                        </div>
                    </div>

                    <div class="p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
                        <h3 class="text-lg font-semibold text-yellow-800 mb-2">Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª:</h3>
                        <div class="space-y-2 text-sm">
                            <div>âœ… VITE_GOOGLE_MAPS_API_KEY Ù…ÙˆØ¬ÙˆØ¯</div>
                            <div>âœ… import.meta.env.VITE_GOOGLE_MAPS_API_KEY ÙŠØ¹Ù…Ù„</div>
                            <div>âœ… URLSearchParams ÙŠØ¨Ù†ÙŠ URL Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­</div>
                            <div>âœ… script.onload ÙŠØªÙ… Ø§Ø³ØªØ¯Ø¹Ø§Ø¤Ù‡</div>
                        </div>
                    </div>
                </div>

                <!-- Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø®Ø±ÙŠØ·Ø© -->
                <div class="space-y-4">
                    <div class="p-4 bg-gray-50 border border-gray-200 rounded-lg">
                        <h3 class="text-lg font-semibold text-gray-800 mb-3">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø®Ø±ÙŠØ·Ø©:</h3>
                        <div id="map" class="map-container border-2 border-gray-200 rounded-lg"></div>
                    </div>

                    <div class="text-center space-y-2">
                        <button onclick="testApiCall()" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors w-full">
                            Ø§Ø®ØªØ¨Ø§Ø± Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ API
                        </button>
                        <button onclick="checkEnvironment()" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-colors w-full">
                            ÙØ­Øµ Ø§Ù„Ø¨ÙŠØ¦Ø©
                        </button>
                        <button onclick="clearMap()" class="bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700 transition-colors w-full">
                            Ù…Ø³Ø­ Ø§Ù„Ø®Ø±ÙŠØ·Ø©
                        </button>
                    </div>
                </div>
            </div>

            <!-- Ø³Ø¬Ù„ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« -->
            <div class="mt-6 p-4 bg-gray-50 border border-gray-200 rounded-lg">
                <h3 class="text-lg font-semibold text-gray-800 mb-3">Ø³Ø¬Ù„ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«:</h3>
                <div id="eventLog" class="bg-black text-green-400 p-4 rounded font-mono text-sm h-32 overflow-y-auto">
                    <div>ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±...</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let mapInstance = null;
        const eventLog = document.getElementById('eventLog');

        function log(message) {
            const timestamp = new Date().toLocaleTimeString();
            eventLog.innerHTML += `<div>[${timestamp}] ${message}</div>`;
            eventLog.scrollTop = eventLog.scrollHeight;
        }

        function testApiCall() {
            log('Ø¨Ø¯Ø¡ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ API...');
            
            const apiKey = prompt('Ø£Ø¯Ø®Ù„ Ù…ÙØªØ§Ø­ Google Maps API:');
            if (!apiKey) {
                log('âŒ Ù„Ù… ÙŠØªÙ… Ø¥Ø¯Ø®Ø§Ù„ Ù…ÙØªØ§Ø­ API');
                return;
            }

            log(`âœ… Ù…ÙØªØ§Ø­ API: ${apiKey.substring(0, 10)}...`);

            // Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© ÙÙŠ Ø§Ù„ÙƒÙˆØ¯
            const GOOGLE_MAPS_LIBRARIES = ['maps'];
            const params = new URLSearchParams({
                key: apiKey,
                libraries: GOOGLE_MAPS_LIBRARIES.join(','),
                v: 'weekly',
                callback: 'initGoogleMaps'
            });

            const scriptUrl = `https://maps.googleapis.com/maps/api/js?${params.toString()}`;
            log(`ğŸ”— URL Ø§Ù„Ù…ÙÙ†Ø´Ø£: ${scriptUrl}`);

            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø³ÙƒØ±ÙŠØ¨Øª Ø§Ù„Ø³Ø§Ø¨Ù‚
            const existingScript = document.getElementById('google-maps-script');
            if (existingScript) {
                existingScript.remove();
                log('ğŸ—‘ï¸ ØªÙ… Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø³ÙƒØ±ÙŠØ¨Øª Ø§Ù„Ø³Ø§Ø¨Ù‚');
            }

            // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø³ÙƒØ±ÙŠØ¨Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯
            const script = document.createElement('script');
            script.id = 'google-maps-script';
            script.src = scriptUrl;
            script.async = true;
            script.defer = true;

            script.onload = function() {
                log('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³ÙƒØ±ÙŠØ¨Øª Ø¨Ù†Ø¬Ø§Ø­');
                if (window.google && window.google.maps) {
                    log('âœ… Google Maps API Ù…ØªØ§Ø­');
                    initMap();
                } else {
                    log('âŒ Google Maps API ØºÙŠØ± Ù…ØªØ§Ø­');
                }
            };

            script.onerror = function(error) {
                log('âŒ ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³ÙƒØ±ÙŠØ¨Øª');
                log(`Ø®Ø·Ø£: ${error.message || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}`);
            };

            document.head.appendChild(script);
            log('ğŸ“¤ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³ÙƒØ±ÙŠØ¨Øª');
        }

        function initMap() {
            try {
                log('ğŸ—ºï¸ Ø¨Ø¯Ø¡ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø®Ø±ÙŠØ·Ø©...');
                
                mapInstance = new google.maps.Map(document.getElementById('map'), {
                    center: { lat: 23.5880, lng: 58.3829 },
                    zoom: 13,
                    mapTypeControl: true,
                    streetViewControl: false,
                    fullscreenControl: false
                });

                const marker = new google.maps.Marker({
                    position: { lat: 23.5880, lng: 58.3829 },
                    map: mapInstance,
                    title: 'Ù…Ø³Ù‚Ø·ØŒ Ø¹Ù…Ø§Ù†'
                });

                log('âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ø¨Ù†Ø¬Ø§Ø­');
                log('ğŸ‰ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ù…ÙƒØªÙ…Ù„ Ø¨Ù†Ø¬Ø§Ø­!');
            } catch (error) {
                log(`âŒ Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø®Ø±ÙŠØ·Ø©: ${error.message}`);
            }
        }

        function checkEnvironment() {
            log('ğŸ” ÙØ­Øµ Ø§Ù„Ø¨ÙŠØ¦Ø©...');
            
            // ÙØ­Øµ Ø§Ù„Ù…ØªØµÙØ­
            if (typeof window !== 'undefined') {
                log('âœ… window Ù…ØªØ§Ø­');
            } else {
                log('âŒ window ØºÙŠØ± Ù…ØªØ§Ø­');
            }

            // ÙØ­Øµ Google Maps
            if (window.google && window.google.maps) {
                log('âœ… Google Maps Ù…ØªØ§Ø­');
            } else {
                log('âŒ Google Maps ØºÙŠØ± Ù…ØªØ§Ø­');
            }

            // ÙØ­Øµ URLSearchParams
            if (typeof URLSearchParams !== 'undefined') {
                log('âœ… URLSearchParams Ù…ØªØ§Ø­');
            } else {
                log('âŒ URLSearchParams ØºÙŠØ± Ù…ØªØ§Ø­');
            }

            log('âœ… ÙØ­Øµ Ø§Ù„Ø¨ÙŠØ¦Ø© Ù…ÙƒØªÙ…Ù„');
        }

        function clearMap() {
            if (mapInstance) {
                mapInstance = null;
            }
            document.getElementById('map').innerHTML = '';
            log('ğŸ—‘ï¸ ØªÙ… Ù…Ø³Ø­ Ø§Ù„Ø®Ø±ÙŠØ·Ø©');
        }

        // Ø¯Ø§Ù„Ø© callback Ù„Ø®Ø±Ø§Ø¦Ø· Ø¬ÙˆØ¬Ù„
        window.initGoogleMaps = function() {
            log('ğŸ“ ØªÙ… Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ callback initGoogleMaps');
        };

        // Ø¨Ø¯Ø¡ Ø§Ù„ÙØ­Øµ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
        checkEnvironment();
    </script>
</body>
</html>
